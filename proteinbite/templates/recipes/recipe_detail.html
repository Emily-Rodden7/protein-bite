{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Recipe Details</title>
    <link rel="stylesheet" href="{% static 'recipes/styles.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<!-- Navigation bar -->
<div class="navbar">
    <!-- Logo on the left -->
    <a href="/" class="navbar-logo">
        <img src="{% static 'recipes/images/proteinbite-logo.png' %}" alt="Protein Bite Logo" class="logo">
    </a>

    <!-- Navigation links on the right -->
    <div class="navbar-links">
        {% if user.is_authenticated %}
            <span class="welcome-message">Welcome, {{ user.username }}!</span>
            <a href="{% url 'home' %}" class="{% if request.path == '/' %}active{% endif %}">Home</a>
            <a href="{% url 'about' %}" class="{% if request.path == '/about/' %}active{% endif %}">About</a>
            <a href="{% url 'recipes' %}" class="{% if request.path == '/recipes/' %}active{% endif %}">Recipes</a>
            <a href="{% url 'account' %}" class="{% if request.path == '/account/' %}active{% endif %}">Account</a>
            <a href="#" id="logout-link" class="{% if request.path == '/logout/' %}active{% endif %}">Log Out</a>
        {% else %}
            <a href="{% url 'home' %}" class="{% if request.path == '/' %}active{% endif %}">Home</a>
            <a href="{% url 'about' %}" class="{% if request.path == '/about/' %}active{% endif %}">About</a>
            <a href="{% url 'recipes' %}" class="{% if request.path == '/recipes/' %}active{% endif %}">Recipes</a>
            <a href="{% url 'login' %}" class="{% if request.path == '/login/' %}active{% endif %}">Log In</a>
        {% endif %}
    </div>
</div>

<!-- Hidden logout form -->
 <form id="logout-form" method="POST" action="{% url 'logout' %}" style="display: none;">
    {% csrf_token %}
</form>

    <!-- Hero background and title text -->
    <div class="colour-hero">
    <div class="colourhero-text">
        <h1>{{ recipe.name }}</h1>
    </div>
</div>

<!-- Recipe detail layout -->
<div class="recipe-detail-container">
    <!-- Left side: nutrients + method -->
    <div class="recipe-left">
        <div class="nutrients">
            <h2>Nutritional Information</h2>
            <p><strong>Calories:</strong> {{ recipe.calories }}</p>
            <p><strong>Protein:</strong> {{ recipe.protein_grams }}g</p>
            <p><strong>Portion Size:</strong> {{ recipe.portion_size }}</p>
            <p><strong>Meat Type:</strong> {{ recipe.meat_type }}</p>
        </div>

        <div class="method">
            <h2>Method</h2>
            <p>{{ recipe.method|linebreaks }}</p>
        </div>
    </div>

    <!-- Right side: image -->
    <div class="recipe-image">
        {% if recipe.image %}
            <img src="{{ recipe.image.url }}" alt="{{ recipe.name }}">
        {% else %}
            <img src="/static/recipes/images/picturecomingsoon.png" alt="Picture Coming Soon">
        {% endif %}
    </div>
</div>

<!-- Comments Section -->
<div class="comments-section">
  <h2>Comments</h2>

  <!-- List of comments -->
  <div class="comment-list">
    {% for comment in comments %}
      <div class="comment">
        <p class="comment-meta">
          <strong>{{ comment.user.username }}</strong> 
          <span class="comment-date">{{ comment.created_at|date:"M d, Y H:i" }}</span>
        </p>
        <p class="comment-body">{{ comment.body }}</p>
      </div>
    {% empty %}
      <p class="no-comments">No comments yet. Be the first to comment!</p>
    {% endfor %}
  </div>

  <!-- Comment Form -->
  {% if user.is_authenticated %}
    <div class="comment-form">
      <h3>Leave a Comment</h3>
      <form method="post">
        {% csrf_token %}
        {{ comment_form.body.label_tag }}
        {{ comment_form.body }}
        <button type="submit">Post Comment</button>
      </form>
    </div>
  {% else %}
    <div class="comment-login-prompt">
      <p>If you would like to leave a comment, please sign in or create an account:</p>
      <div class="comment-buttons">
        <a href="{% url 'register' %}" class="btn">Sign Up</a>
        <a href="{% url 'login' %}" class="btn">Log In</a>
      </div>
    </div>
  {% endif %}
</div>

<!-- Footer -->
<footer class="footer">
  <div class="footer-content">
    <p>&copy; 2025 Protein Bite. All rights reserved.</p>
    
    <ul class="footer-links">
      <li><a href="/">Home</a></li>
      <li><a href="/about/">About</a></li>
      <li><a href="/recipes/">Recipes</a></li>
      <li>
        {% if user.is_authenticated %}
          <a href="#" id="logout-link-footer">Log Out</a>
        {% else %}
          <a href="{% url 'login' %}">Log In</a>
        {% endif %}
      </li>
    </ul>

    <div class="social-icons">
      <a href="https://facebook.com" target="_blank"><i class="fab fa-facebook-f"></i></a>
      <a href="https://twitter.com" target="_blank"><i class="fab fa-twitter"></i></a>
      <a href="https://instagram.com" target="_blank"><i class="fab fa-instagram"></i></a>
      <a href="https://linkedin.com" target="_blank"><i class="fab fa-linkedin-in"></i></a>
    </div>
  </div>
</footer>

<!-- Javascript section -->
 <!-- logout section -->
<script>
    document.getElementById('logout-link').addEventListener('click', function(event) {
        event.preventDefault();
        document.getElementById('logout-form').submit();
    });

    const footerLogoutLink = document.getElementById('logout-link-footer');
    if (footerLogoutLink) {
        footerLogoutLink.addEventListener('click', function(event) {
            event.preventDefault();
            document.getElementById('logout-form').submit();
        });
    }
</script>
</body>
</html>